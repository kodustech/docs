---
title: "运行 Web 应用程序"
description: "在本地计算机上运行 Kodus Web 应用程序的快速入门指南。"
icon: "browser"
---

<Note>
  本指南用于本地开发目的。对于生产部署，请参阅[部署 Kodus](/how_to_deploy/en/deploy_kodus/generic_vm) 指南。
</Note>

## 先决条件

- Node.js（LTS 版本）
- Yarn 或 NPM
- Docker
- **Kodus API 正在运行**（请参阅[编排器设置](/how_to_deploy/en/local_quickstart/orchestrator)）
- LLM API 密钥

## 运行项目

<Tabs>
  <Tab title="自动设置（推荐）">
    要进行快速自动设置，请使用我们的设置脚本：

    ```bash
    git clone https://github.com/kodustech/web.git
    cd kodus-web
    yarn dev:first-run
    ```

    此脚本将自动：
    - ✅ 检查 `.env.example` 是否存在
    - ✅ 生成安全的 NextAuth 密钥
    - ✅ 处理与 API 的 JWT 密钥同步
    - ✅ 创建和配置 `.env` 文件
    - ✅ 提供清晰的后续步骤

    <Info>
      **JWT 密钥选项：**
      - **选项 1**：使用现有的 API JWT 密钥（如果已配置 API，则推荐）
      - **选项 2**：生成新的 JWT 密钥（复制到 API .env 文件）
      - **选项 3**：暂时跳过 JWT 设置
    </Info>

    运行脚本后，您只需要：
    ```bash
    yarn install
    yarn docker:start
    ```

  </Tab>
  <Tab title="手动设置">
    如果您更喜欢手动配置所有内容：

    ### 1. 克隆仓库

    ```bash
    git clone https://github.com/kodustech/kodus-web.git
    ```

    ### 2. 安装依赖项

    ```bash
    yarn install
    ```

    ### 3. 配置环境变量

    ```bash
    cp .env.example .env
    ```

    ### 4. 生成安全密钥

    在配置环境变量之前，您需要生成安全密钥：

    ```bash
    # 生成 NextAuth 密钥
    openssl rand -base64 32

    # 生成 JWT 密钥（应与您的 API 匹配）
    openssl rand -base64 32
    ```

    您需要在 `.env` 中配置这些变量：
    - `WEB_NEXTAUTH_SECRET` - NextAuth.js 密钥
    - `WEB_JWT_SECRET_KEY` - JWT 密钥（必须与 API 的 `API_JWT_SECRET` 匹配）

    ### 5. 配置 API 连接

    确保您的 Web 应用程序可以连接到 Kodus API：

    ```env
    # API 配置
    NEXT_PUBLIC_API_URL=http://localhost:3001
    NEXT_PUBLIC_API_HOST=localhost:3001
    ```

    ### 6. 配置身份验证

    在 `.env` 中设置身份验证提供商：

    ```env
    # NextAuth 配置
    NEXTAUTH_URL=http://localhost:3000
    NEXTAUTH_SECRET=your_generated_secret

    # JWT 配置
    WEB_JWT_SECRET_KEY=your_generated_jwt_secret
    ```

    <Warning>
      **重要**：`WEB_JWT_SECRET_KEY` 必须与 API `.env` 文件中的 `API_JWT_SECRET` 匹配，身份验证才能正常工作。
    </Warning>

    ### 7. 启动开发环境

    启动开发服务器：

    ```bash
    yarn docker:build
    yarn docker:start
    ```

    应用程序将在 `http://localhost:3000` 上可用

  </Tab>
</Tabs>

## 开发工作流程

### 基本本地开发

1. **启动服务**：`yarn docker:start`
2. **访问 Web 应用**：`http://localhost:3000`
3. **监控日志**：`yarn docker:logs`

### 与 API 集成的开发

如果您正在使用 Kodus API 进行开发：

1. **确保 API 正在运行**：API 应可在 `http://localhost:3001` 访问
2. **验证 JWT 密钥匹配**：Web 和 API 必须使用相同的 JWT 密钥
3. **测试身份验证**：尝试登录以验证连接

## 服务端点

访问应用程序：
- 开发：`http://localhost:3000`
- API（外部）：`http://localhost:3001`

## 故障排除

### 常见问题

**身份验证不工作：**
- 验证 Web 和 API 之间的 JWT 密钥是否匹配
- 检查 API 是否正在运行且可访问
- 确保 `NEXT_PUBLIC_API_URL` 正确

**构建失败：**
- 清除 Docker 缓存：`docker system prune -a`
- 重建：`yarn docker:build --no-cache`

**环境变量未加载：**
- 验证项目根目录中存在 `.env` 文件
- 检查 `.env` 文件中的语法错误
- 在 `.env` 更改后重启 Docker 服务

**API 连接问题：**
- 验证 API 是否在端口 3001 上运行
- 检查容器之间的网络连接
- 验证 API 健康端点：`http://localhost:3001/health`

### 获取帮助

如果遇到问题：
1. 检查日志：`yarn docker:logs`
2. 验证 API 状态：确保 Kodus API 正在运行
3. 检查环境变量：确保设置了所有必需的值
4. 查看 [API 设置指南](/how_to_deploy/en/local_quickstart/orchestrator) 了解后端配置
